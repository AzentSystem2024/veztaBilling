<dx-data-grid
  id="gridContainer"
  [dataSource]="departments"
  [remoteOperations]="true"
  [allowColumnReordering]="true"
  [rowAlternationEnabled]="true"
  [showBorders]="true"
  [showRowLines]="true"
  (onEditingStart)="onEditingStart($event)"
  [width]="'100%'"
  [height]="'90vh'"
  (onRowRemoving)="delete_Department_Data($event)"
  (onExporting)="onExporting($event)"
  id="dataGrid"
  [pager]="{
    showInfo: true,
    infoText: 'Page {0} of {1}',
    showNavigationButtons: true
  }"
>
  <dxo-scrolling mode="virtual"></dxo-scrolling>
  <dxo-export [enabled]="true" [formats]="['xlsx', 'pdf']"> </dxo-export>

  <dxo-editing
    mode="popup"
    [allowUpdating]="true"
    [allowDeleting]="true"
    [useIcons]="true"
    editIcon="edit"
  ></dxo-editing>

  <dxo-toolbar>
    <dxi-item
      location="before"
      text="Department"
      cssClass="font-bold text-lg"
    ></dxi-item>
    <!-- <dxi-item name="searchPanel" locateInMenu="auto"></dxi-item> -->
    <dxi-item name="" locateInMenu="auto"></dxi-item>
    <dxi-item location="after" locateInMenu="auto">
      <dx-button
        icon="plus"
        type="default"
        stylingMode="contained"
        (onClick)="openPopup()"
      ></dx-button>
    </dxi-item>

    <dxi-item name="exportButton"></dxi-item>
  </dxo-toolbar>

  <dxo-search-panel
    [visible]="true"
    [highlightCaseSensitive]="true"
  ></dxo-search-panel>
  <!-- <dxi-column
    dataField="SlNo"
    [width]="80"
    caption="Sl.No"
    [allowEditing]="false"
    alignment="left">
  </dxi-column> -->
  <dxi-column
    dataField="DEPARTMENT"
    alignment="left"
    caption="Department"
  ></dxi-column>
  <dxi-column
    dataField="HOSPITAL_ID"
    alignment="left"
    caption="Hospital"
  ></dxi-column>
  <dxi-column
    dataField="IS_INACTIVE"
    alignment="left"
    caption="Status"
    [calculateCellValue]="formatStatus"
    [cellTemplate]="statusCellTemplate"
  ></dxi-column>
  <dxi-column type="buttons" [width]="110">
    <dxi-button name="edit"></dxi-button>
    <dxi-button name="delete"></dxi-button>
  </dxi-column>

  <dxo-header-filter [visible]="true">
    <dxo-search [enabled]="true"></dxo-search>
  </dxo-header-filter>

  <dxo-paging [pageSize]="10"></dxo-paging>
  <dxo-pager
    [visible]="true"
    [showPageSizeSelector]="true"
    [allowedPageSizes]="[10, 25, 50, 100]"
  ></dxo-pager>
</dx-data-grid>

<!-- =========== Add the Department================ -->
<dx-popup
  [title]="'Department'"
  [(visible)]="isAddPop"
  [width]="400"
  [height]="300"
  [shading]="false"
  (onHiding)="closePopup()"
>
  <form [formGroup]="formsource">
    <div style="display: flex; align-items: center; gap: 20px">
      <label>Department</label>
      <dx-text-box
        type="text"
        name="Department"
        class="form-control"
        formControlName="DepartmentName"
      ></dx-text-box>
    </div>

    <div class="d-flex">
      <label style="margin-top: 17px">Hospital</label>

 <dx-select-box
  formControlName="Hospital"
  style="flex: 1; margin-left: 44px; margin-top: 17px"
  [searchEnabled]="true"
  displayExpr="name"
  valueExpr="id"
  (onValueChanged)="changeHospitals($event)"
></dx-select-box>

    </div>

    <label for="checboxadd" class="me-5">Inactive </label>
    <dx-check-box
      class="mt-4"
      formControlName="Status"
      [elementAttr]="{ 'aria-label': 'Unchecked' }"
      id="checboxadd"
    ></dx-check-box>
    <div class="d-flex justify-content-end mt-4">
      <!-- Cancel Button -->
      <button
        class="btn me-1 text-dark border border-1 equal-button"
        (click)="closePopup()"
      >
        Cancel
      </button>

      <!-- Save Button -->
      <dx-button
        text="Save"
        class="equal-button"
        type="default"
        stylingMode="contained"
        (onClick)="addData()"
      ></dx-button>
    </div>
  </form>
</dx-popup>

<!-- // =========== Edit the Department================ -->

<dx-popup
  [title]="' Department'"
  [(visible)]="isEditPop"
  [width]="400"
  [height]="300"
  [shading]="false"
  (onHiding)="closePopup()"
>
  <form [formGroup]="formsource">
    <div style="display: flex; align-items: center; gap: 20px">
      <label>Department</label>
      <dx-text-box
        type="text"
        name="Department"
        class="form-control"
        [(value)]="department_Value"
      ></dx-text-box>
    </div>

    <div class="d-flex">
      <label style="margin-top: 17px">Hospital</label>

   <dx-select-box
  [(value)]="updatedDepartmentData.Hospital"
  displayExpr="name"
  valueExpr="id"
  style="flex: 1; margin-left: 44px; margin-top: 17px"
  [searchEnabled]="true"
  (onValueChanged)="changeHospitals($event)"
></dx-select-box>

    </div>

    <label for="checboxadd" class="me-5">Inactive </label>
    <dx-check-box
      class="mt-4"
      [(value)]="status_value"
      [elementAttr]="{ 'aria-label': 'Unchecked' }"
      id="checboxadd"
    ></dx-check-box>
    <div class="d-flex justify-content-end mt-4">
      <!-- Cancel Button -->
      <button
        class="btn me-1 text-dark border border-1 equal-button"
        (click)="closePopup()"
      >
        Cancel
      </button>

      <!-- Save Button -->
      <dx-button
        text="Update"
        class="equal-button"
        type="default"
        stylingMode="contained"
        (onClick)="update_Department_Data()"
      ></dx-button>
    </div>
  </form>
</dx-popup>
